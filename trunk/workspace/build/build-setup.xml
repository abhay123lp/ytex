<project name="build-setup" default="help">
	<!-- override these variables using eclipse settings/command line -->
	<property name="maveric.home" value="C:/java/MavericArcApp-1.0.0" />
	<property name="ytex.home" value="../" />
	<property name="ytex.properties" value="${ytex.home}/config/desc/ytex.properties" />
	<target name="help">
<echo>
Ant build script to setup ytex.
Call with option -projecthelp for more info.
</echo>
	</target>
	
	<target name="all" depends="templateToConfig,setupMavericResources,setupDatabase,setup.ytex.web" />
	<target name="setupDatabase" description="setup ytex database tables">
		<ant dir="${ytex.home}/data.mssql" target="all" />
	</target>
	<target name="templateToConfig" description="generate config files from templates using values specified in ytex.properties">
		<copy todir="${ytex.home}/config/desc" overwrite="yes">
			<fileset dir="${ytex.home}/config/desc" includes="**/*.template.xml" />
			<globmapper from="*.template.xml" to="*.xml" />
			<filterset>
				<filtersfile file="${ytex.properties}" />
			</filterset>
		</copy>
		<copy todir="${ytex.home}/config/desc" overwrite="yes">
			<fileset dir="${ytex.home}/config/desc" includes="**/*.template.properties" />
			<globmapper from="*.template.properties" to="*.properties" />
			<filterset>
				<filtersfile file="${ytex.properties}" />
			</filterset>
		</copy>
	</target>
	<target name="setupMavericResources" description="copy resources from maveric to ytex">
		<delete dir="${ytex.home}/maveric/resources" quiet="yes" />
		<mkdir dir="${ytex.home}/maveric/resources" />
		<copy todir="${ytex.home}/maveric/resources">
			<fileset dir="${maveric.home}">
				<include name="lookup/**/*.*" />
				<include name="lvg/**/*.*" />
				<include name="models/**/*.*" />
				<include name="sentdetect/**/*.*" />
				<include name="tokenizer/**/*.*" />
			</fileset>
		</copy>
	</target>
	<target name="search.templateToConfig" description="setup ytex.web search.properties">
		<!-- default for development environment -->
		<property name="search.properties.path" value="../ytex.web/src/main/java/ytex" />
		<copy file="${search.properties.path}/search.template.properties" tofile="${search.properties.path}/search.properties" overwrite="yes">
			<filterset>
				<filtersfile file="${ytex.properties}" />
			</filterset>
		</copy>
	</target>
	<target name="setup.ytex.web" description="setup ytex.web application for tomcat">
		<property name="context.root" value="ytex.web" />
		<property name="catalina.base" value="${ytex.home}/web/catalina" />
		<mkdir dir="${catalina.base}/temp" />
		<antcall target="search.templateToConfig">
			<param name="search.properties.path" value="${catalina.base}/webapps/${context.root}/WEB-INF/classes/ytex" />
		</antcall>
		<echo>
Default search.properties set up in ${catalina.base}/webapps/${context.root}/WEB-INF/classes/ytex.
Modify to match your configuration.
		</echo>
	</target>
</project>